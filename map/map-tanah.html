<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Peta Dunia Alami - Hutan & Sungai</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100%;
    background: #1b3a24;
  }
  canvas {
    display: block;
    background: linear-gradient(180deg, #2f5a33, #1b3a24);
    cursor: grab;
  }
</style>
</head>
<body>
<canvas id="map"></canvas>

<script>
// ===== SETUP DASAR =====
const canvas = document.getElementById("map");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const mapSize = 12000;   // luas dunia besar
let camX = mapSize / 2 - window.innerWidth / 2;
let camY = mapSize / 2 - window.innerHeight / 2;
let scale = 1;

// ===== GENERATOR WARNA TANAH / HUTAN / AIR =====
function generateColor(x, y) {
  // gunakan pola acak halus berdasarkan posisi
  const nx = x / mapSize - 0.5;
  const ny = y / mapSize - 0.5;
  const noise = Math.sin(nx * 40) * Math.cos(ny * 40) +
                Math.sin(nx * 10) * Math.cos(ny * 10) +
                Math.random() * 0.2;

  // peta ketinggian
  const h = (noise + 1) / 2; // 0..1

  // air
  if (h < 0.38) {
    const blue = 180 + h * 50;
    return `rgb(${blue * 0.3}, ${blue * 0.6}, ${blue})`;
  }
  // pantai
  if (h < 0.42) return `rgb(205, 189, 121)`;
  // hutan
  if (h < 0.7) {
    const g = 80 + h * 80;
    return `rgb(${g * 0.5}, ${g}, ${g * 0.5})`;
  }
  // gunung
  const grey = 80 + h * 100;
  return `rgb(${grey}, ${grey * 0.95}, ${grey * 0.9})`;
}

// ===== BUAT TEKSTUR PETA =====
const offCanvas = document.createElement("canvas");
offCanvas.width = mapSize;
offCanvas.height = mapSize;
const offCtx = offCanvas.getContext("2d");
offCtx.imageSmoothingEnabled = true;

const img = offCtx.createImageData(mapSize, mapSize);
for (let y = 0; y < mapSize; y++) {
  for (let x = 0; x < mapSize; x++) {
    const color = generateColor(x, y);
    const [r, g, b] = color.match(/\d+/g).map(Number);
    const index = (y * mapSize + x) * 4;
    img.data[index] = r;
    img.data[index + 1] = g;
    img.data[index + 2] = b;
    img.data[index + 3] = 255;
  }
}
offCtx.putImageData(img, 0, 0);

// ===== RENDER PETA =====
function draw() {
  ctx.setTransform(scale, 0, 0, scale, -camX * scale, -camY * scale);
  ctx.imageSmoothingEnabled = true;
  ctx.drawImage(offCanvas, 0, 0);
}
draw();

// ===== GESER (DRAG) =====
let dragging = false, lastX, lastY;
canvas.addEventListener("mousedown", e => {
  dragging = true;
  lastX = e.clientX;
  lastY = e.clientY;
  canvas.style.cursor = "grabbing";
});
window.addEventListener("mouseup", () => {
  dragging = false;
  canvas.style.cursor = "grab";
});
window.addEventListener("mousemove", e => {
  if (dragging) {
    camX -= (e.clientX - lastX) / scale;
    camY -= (e.clientY - lastY) / scale;
    lastX = e.clientX;
    lastY = e.clientY;
    draw();
  }
});

// ===== ZOOM =====
window.addEventListener("wheel", e => {
  e.preventDefault();
  const zoomIntensity = 0.1;
  const oldScale = scale;
  scale *= e.deltaY < 0 ? (1 + zoomIntensity) : (1 - zoomIntensity);
  scale = Math.max(0.2, Math.min(scale, 6));
  draw();
});

// ===== RESIZE =====
window.addEventListener("resize", () => {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  draw();
});
</script>
</body>
</html>
